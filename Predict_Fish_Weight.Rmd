---
title: "Weight of Fish"
author: "Michelle Cervantes"
date: "November 4, 2020"
output: 
  html_document:
    number_sections: true
    toc: true
---


```{r include=FALSE,echo=FALSE}
require(tigerstats)
require(tidyverse)
```

# Introduction

<!--In this section you explain what you are trying to show.  Where did the data come from?  What is the research or other question you are trying to answer?!-->

In this assignment I am trying to show the best regression models that help predict the weight of 3 different species of fish which is the Perch, Bream and Smelt. 


## Build the best regression model you can that predicts the weight of perch
## Using only two predictor variables  



# Perch Model

<!--Decide on your methods:  use "variable analysis" or other appropriate descriptors.  Make sure to choose at least one graphical method and at least one numerical method.!-->

```{r}
# read in the fish data
fishdata <- read.csv(file="Fish.csv", header=TRUE) 
PerchData <- filter(fishdata,Species=="Perch") %>% select(-Species)
```
Now Build our Models 

```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = PerchData,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottomright",main="Adjusted R^2")
```
  
### The best two regressor model for Perch is Height and Width, this is also the best overall model as measured by adjusted R-squared.

# Bream Model

<!--Divide this section into two sub-sections:  One for your descriptive  results and one for your inferential results.!-->

```{r}
# read in the fish data
fishdata <- read.csv(file="Fish.csv", header=TRUE) 
BreamData <- filter(fishdata,Species=="Bream") %>% select(-Species)
```
Now Build our Models

```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = BreamData,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottomright",main="Adjusted R^2")
```
  
Based on this model, we can see that the best option with 2 regressors that will predict the weight of a Bream is one that contains data from Length2 and Height. Unlike the Perch model, this model for Bream does not align perfectly with a specific Adjusted R-squared value, however it is very close to aligning with the value 0.936.

### The best regressor model for Bream is Length2 and Height, this is one out of two models that is the closest to the adjusted R-squared value of 0.936. 

# Smelt Model

```{r}
# read in the fish data
fishdata <- read.csv(file="Fish.csv", header=TRUE) 
SmeltData <- filter(fishdata,Species=="Smelt") %>% select(-Species)
```
Now Build our Models
  
```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = SmeltData,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottomright",main="Adjusted R^2")
```

### Discussion and Final Conclusion

<!--Graphical results here.  Make sure to show your code.  Provide appropriate labels for axes, giving units if possible, and provide a good title for the graph, too.  Use the graphical results to describe the patterns if any that exist in the data as focused toward the research question!-->

